#Adam karim
#https://www.digitalocean.com/community/tutorials/how-to-crawl-a-web-page-with-scrapy-and-python-3 was the tutorial used to help create this scraper.
import scrapy

class MalwareSpider(scrapy.Spider):
    name = "malware_spider"
    user_agent = "Chrome/22.0.1207.1"
    start_urls = ['http://vxvault.net/ViriList.php?s=0&m=40']
    
    def parse(self, response):#Gathers all text data from the website and stores it in a file
        CLAIR_SELECTOR = '.clair' #clair is the class on the vxvault website 
        FONCE_SELECTOR = '.fonce' #fonce is the class on the vxvault website 
        for malware in response.css(FONCE_SELECTOR): #I run the code twice with each selector inputted due to the time it takes to scrape all the data
            NAME_SELECTOR = 'a ::text'    
            #NAME_SELECTOR1 = '//td/a/text()'
            yield{
                'website':malware.css(NAME_SELECTOR).getall()
            }
        #Goes to the next page of the website    
        NEXT_PAGE_SELECTOR = '#selector a ::attr(href)'
        next_page = response.css(NEXT_PAGE_SELECTOR).extract()[2] #the [2] is there to choose the third href index due to the structure of the website.
        if next_page:
            yield scrapy.Request(
                response.urljoin(next_page),
                callback = self.parse
                )
           
    
            